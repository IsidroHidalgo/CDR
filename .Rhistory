equipo <- as.vector(datos$AwayTeam[i])
}
goleador <- str_split(goleador,"\\(")
goleador <- unlist(goleador)
goleador <- c(as.numeric(datos$Round_ID[i]),goleador,equipo)
goleadores <- rbind(goleadores,goleador,stringsAsFactors = FALSE)
}
names(goleadores)<-c("Round_ID","Jugador","Minuto","Equipo")
}
View(goleadores)
fwrite(goleadores,"GoleadoresBundesligaA2122.csv")
goleadores <- fread("GoleadoresSerieA2122.csv")
View(goleadores)
library(dplyr)
goleadores %>% group_by(Jugador,Equipo) %>% summarise(n=n())
goles_jug_eq <- goleadores %>% group_by(Jugador,Equipo) %>% summarise(n=n())
View(goles_jug_eq)
setwd("C:/Users/mmfus/Downloads")
datos <- fread("SerieA2122.csv")
datos$Round_ID <- sort(rep(1:38,10))
i=1
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string
View(datos)
i=85
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- limpieza(string,datos$clean1[i],datos$clean2[i])
string
partes <- str_split(string," ")
partes
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
partes <- str_split(string," ")
partes
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goleadores <- rbind(goleadores,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- limpieza(string,datos$clean1[i],datos$clean2[i])
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- str_split(string,"\\(")
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goles_propia <- rbind(goleador,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goleadores <- rbind(goleadores,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- str_split(string,"\\(")
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goles_propia <- rbind(goleador,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- str_split(string,"\\(")
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goles_propia <- rbind(goleador,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
View(datos)
View(goles_propia)
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(string,"\\("))
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
View(datos)
View(goles_propia)
i
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
partes
partes <- unlist(partes)
partes <- str_split(string," ")
partes <- unlist(partes)
partes
partes <- str_split(string," ")
partes
View(datos)
i=379
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
string
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes
partes <- unlist(str_split(string,"\\("))
partes
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
partes
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goleador
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
is.null(partes)
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
View(datos)
View(goles_propia)
fwrite(goles_propia,"AutoGolSerieA2122.csv")
datos <- fread("LaLiga2122.csv")
datos$Round_ID <- sort(rep(1:38,10))
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goleadores)<-c("Round_ID","Jugador","Propia")
names(goles_propia)<-c("Round_ID","Jugador","Propia")
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goles_propia)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
fwrite(goles_propia,"AutoGolLaLiga2122.csv")
datos <- fread("Ligue2122.csv")
datos$Round_ID <- sort(rep(1:38,10))
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goles_propia)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
fwrite(goles_propia,"AutoGolLigue2122.csv")
datos <- fread("Premier2122.csv")
View(datos)
datos$Round_ID <- sort(rep(1:38,10))
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goles_propia)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
i=141
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
i=140
datos[140,]
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
for(i in 141:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
fwrite(goles_propia,"AutoGolPremier2122.csv")
datos <- fread("Bundesliga2122.csv")
names(datos)[c(1,3:6)]<-c("Match_ID","HomeTeam","Result","AwayTeam","link")
datos$Round_ID <- sort(rep(1:34,9))
goles_propia <- data.frame(matrix(ncol=3,nrow=0))
names(goles_propia)<-c("Round_ID","Jugador","Propia")
for(i in 1:nrow(datos)){
print(i)
# Si no hay goles
if(datos$Result[i]=="0 - 0"){
goleador <- c(datos$Round_ID[i],NA,NA)
goles_propia <- rbind(goles_propia,goleador)
next()}
url <- str_c("https://www.soccerstats.com/",datos$link[i])
# Extraemos el codigo HTML
pagina_web <- try(read_html(url))
texto_GAG  <- html_text(pagina_web)
# Marcamos el inicio y fin de la string buscada y del half-time
pos_start   <- regexpr('FIRST\n\n\n\n\n\n\n\n\n vs', texto_GAG)
pos_end <- regexpr('FT:',texto_GAG)
pos_HT <- regexpr('HT:',texto_GAG)
# Extraemos la string buscada y la limpiamos
string <- substr(texto_GAG, pos_start+nchar('FIRST\n\n\n\n\n\n\n\n\n vs \n  '),pos_end-1)
string <- gsub(substr(texto_GAG, pos_HT,pos_HT+6),"",string)
string <- gsub(" \\(o.g.\\)","\\(o.g.\\)",string)
# Sacamos resumen de los goles
partes <- str_split(string," ")
partes <- unlist(partes)
partes <- partes[partes %like% "\\(o.g.\\)"]
partes <- unlist(str_split(partes,"\\("))
if(is.null(partes)){
goleador <- goleador <- c(as.numeric(datos$Round_ID[i]),NA,NA)
}else{
goleador <- c(as.numeric(datos$Round_ID[i]),partes)
}
goles_propia <- rbind(goles_propia,goleador,stringsAsFactors = FALSE)
names(goles_propia)<-c("Round_ID","Jugador","Propia")
}
fwrite(goles_propia,"AutoGolBundesliga2122.csv")
